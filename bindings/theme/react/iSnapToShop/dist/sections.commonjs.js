(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>d});var a={};e.r(a),e.d(a,{Component:()=>n,settings:()=>l});const r=require("fs");var i=e.n(r);const o={container:{margin:"0 auto",fontFamily:'"Inter", "SF Pro Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',background:"linear-gradient(135deg,#0C5273 0%,#0C5272 100%)",position:"relative",overflow:"hidden"},title:{textAlign:"center",color:"#ffffff",fontSize:"clamp(2.5rem, 5vw, 4rem)",fontWeight:"800",background:"linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",textShadow:"0 4px 20px rgba(255,255,255,0.3)",letterSpacing:"-0.02em",paddingTop:"20px"},uploadSection:{textAlign:"center",marginBottom:"20px",position:"relative"},customUploadContainer:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"20px",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",padding:"20px 30px",borderRadius:"24px",marginBottom:"0px",color:"#fff",cursor:"pointer",transition:"all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)",position:"relative",overflow:"hidden"},mainUploadButton:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",padding:"16px 32px",background:"linear-gradient(135deg, #e9e9e9 0%, #e2d4e9 50%, #efefef 100%)",color:"black",border:"none",borderRadius:"50px",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)",minWidth:"220px",margin:"0 auto",boxShadow:"0 10px 30px rgba(102, 126, 234, 0.4)",position:"relative",overflow:"hidden","&:hover":{transform:"translateY(-2px)",boxShadow:"0 15px 40px rgba(102, 126, 234, 0.6)"},"&:active":{transform:"translateY(0)"}},quickText:{fontWeight:"700",fontSize:"1.2em",background:"linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,animation:"modalFadeIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)"},modalContent:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderRadius:"24px",width:"90%",maxWidth:"500px",maxHeight:"90vh",overflow:"hidden",border:"2px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 25px 50px rgba(0, 0, 0, 0.25)",animation:"modalSlideUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)"},modalHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"25px 30px",borderBottom:"1px solid rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.5)"},modalTitle:{margin:0,fontSize:"22px",fontWeight:"700",background:"linear-gradient(135deg, #2d3436 0%, #636e72 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},modalCloseButton:{background:"rgba(255, 255, 255, 0.8)",border:"none",fontSize:"20px",cursor:"pointer",color:"#636e72",padding:"0",width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.3s ease",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)","&:hover":{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444",transform:"rotate(90deg)"}},modalBody:{padding:"30px"},modalSection:{marginBottom:"25px"},modalSectionLabel:{display:"block",marginBottom:"12px",fontSize:"15px",fontWeight:"600",color:"#2d3436",letterSpacing:"0.5px"},fileInput:{width:"100%",padding:"16px 20px",border:"2px solid rgba(102, 126, 234, 0.2)",borderRadius:"16px",fontSize:"15px",background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",transition:"all 0.3s ease","&:focus":{outline:"none",borderColor:"#667eea",boxShadow:"0 0 0 4px rgba(102, 126, 234, 0.1)"}},modalDivider:{textAlign:"center",margin:"30px 0",position:"relative","&:before":{content:'""',position:"absolute",top:"50%",left:0,right:0,height:"1px",background:"linear-gradient(90deg, transparent, rgba(0,0,0,0.1), transparent)"}},modalDividerText:{background:"rgba(255, 255, 255, 0.9)",padding:"0 20px",color:"#636e72",fontSize:"14px",fontWeight:"600",position:"relative",zIndex:1},promptInput:{width:"100%",padding:"16px 20px",border:"2px solid rgba(102, 126, 234, 0.2)",borderRadius:"16px",fontSize:"15px",marginBottom:"20px",boxSizing:"border-box",background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",transition:"all 0.3s ease","&:focus":{outline:"none",borderColor:"#667eea",boxShadow:"0 0 0 4px rgba(102, 126, 234, 0.1)"}},generateButton:{width:"100%",padding:"16px 24px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"16px",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",boxShadow:"0 10px 25px rgba(102, 126, 234, 0.3)",position:"relative",overflow:"hidden","&:hover":{transform:"translateY(-2px)",boxShadow:"0 15px 35px rgba(102, 126, 234, 0.4)"}},generateButtonDisabled:{background:"linear-gradient(135deg, #b2bec3 0%, #636e72 100%)",cursor:"not-allowed",transform:"none",boxShadow:"none"},popupOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"20px",animation:"modalFadeIn 0.4s ease"},popupContent:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,250,252,0.95) 100%)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderRadius:"24px",maxWidth:"1200px",width:"100%",maxHeight:"90vh",overflow:"hidden",border:"2px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 25px 50px rgba(0, 0, 0, 0.25)",animation:"popupSlideIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275)"},popupHeader:{padding:"25px 30px",borderBottom:"1px solid rgba(0, 0, 0, 0.1)",background:"rgba(255, 255, 255, 0.6)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",position:"sticky",top:0,zIndex:10,display:"flex",justifyContent:"space-between",alignItems:"center"},popupTitle:{fontSize:"1.8rem",fontWeight:"800",background:"linear-gradient(135deg, #2d3436 0%, #636e72 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",margin:0,letterSpacing:"-0.02em"},closeButton:{background:"rgba(255, 255, 255, 0.8)",border:"none",borderRadius:"50%",width:"42px",height:"42px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",fontSize:"18px",color:"#636e72","&:hover":{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444",transform:"rotate(90deg) scale(1.1)"}},popupBody:{maxHeight:"80vh",overflowY:"auto",paddingRight:"10px",paddingLeft:"10px",boxSizing:"border-box"},popupImageSection:{padding:"25px",background:"rgba(255, 255, 255, 0.6)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",borderRadius:"20px",marginBottom:"30px",border:"2px solid rgba(102, 126, 234, 0.1)",textAlign:"center",maxHeight:"300px",position:"relative",overflow:"hidden"},popupImageTitle:{fontSize:"20px",fontWeight:"700",marginBottom:"15px",background:"linear-gradient(135deg, #2d3436 0%, #636e72 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},popupSelectedImage:{maxWidth:"100%",maxHeight:"200px",borderRadius:"16px",border:"3px solid rgba(255, 255, 255, 0.8)",boxShadow:"0 15px 35px rgba(0,0,0,0.15)",transition:"transform 0.3s ease","&:hover":{transform:"scale(1.02)"}},selectedImageWrapper:{position:"relative",display:"inline-block"},resultsSection:{marginTop:"30px",borderTop:"2px solid rgba(102, 126, 234, 0.1)",paddingTop:"30px"},resultsTitle:{fontSize:"24px",fontWeight:"800",marginBottom:"25px",background:"linear-gradient(135deg, #2d3436 0%, #636e72 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",letterSpacing:"-0.01em"},loadingText:{textAlign:"center",fontSize:"20px",fontWeight:"600",background:"linear-gradient(135deg, #5DBDCA 0%, #7864AB 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",padding:"40px 0"},noProductsText:{textAlign:"center",fontSize:"18px",color:"#636e72",marginTop:"50px",fontWeight:"500"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:"20px",paddingBottom:"40px"},card:{borderRadius:"20px",background:"rgba(255, 255, 255, 0.96)",border:"1px solid rgba(231, 233, 255, 0.7)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",boxShadow:"0 10px 30px rgba(0,0,0,0.1)",overflow:"hidden",transition:"all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)",border:"2px solid rgba(255, 255, 255, 0.3)",position:"relative","&:hover":{transform:"translateY(-8px) scale(1.02)",boxShadow:"0 25px 50px rgba(0,0,0,0.2)"}},cardImage:{width:"100%",height:"220px",objectFit:"cover",transition:"transform 0.4s ease"},cardTitle:{fontSize:"1.1rem",fontWeight:"700",padding:"15px 20px 8px 20px",color:"#2d3436",lineHeight:"1.4",letterSpacing:"-0.01em"},cardPrice:{fontSize:"1.3rem",fontWeight:"800",background:"linear-gradient(135deg, #e17055 0%, #d63031 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",padding:"0 20px 8px 20px"},cardOriginalPrice:{fontSize:"1rem",color:"#b2bec3",textDecoration:"line-through",marginLeft:"8px",fontWeight:"500"},cardCategory:{fontSize:"0.9rem",color:"#636e72",textTransform:"capitalize",padding:"0 20px 15px 20px",fontWeight:"500",opacity:.8},viewDetailsButton:{margin:"0 20px 0px 20px",padding:"12px 20px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#fff",border:"none",borderRadius:"12px",cursor:"pointer",fontWeight:"600",fontSize:"15px",transition:"all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)",boxShadow:"0 8px 20px rgba(102, 126, 234, 0.3)",position:"relative",overflow:"hidden","&:hover":{transform:"translateY(-2px)",boxShadow:"0 12px 30px rgba(102, 126, 234, 0.4)"}},mobileCard:{display:"flex",flexDirection:"row",alignItems:"flex-start",padding:"20px",background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",borderRadius:"16px",marginBottom:"15px",border:"2px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 8px 25px rgba(0,0,0,0.1)",transition:"all 0.3s ease",width:"100%"},mobileCardImage:{width:"120px",height:"120px",objectFit:"cover",borderRadius:"12px",marginRight:"15px",border:"2px solid rgba(255, 255, 255, 0.8)"},mobileCardContent:{flex:1,display:"flex",flexDirection:"column",justifyContent:"flex-start"},mobileCardTitle:{fontSize:"15px",fontWeight:"700",color:"#2d3436",marginBottom:"6px",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"1.4"},mobileCardPrice:{fontSize:"16px",fontWeight:"800",background:"linear-gradient(135deg, #e17055 0%, #d63031 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",marginBottom:"12px"},mobileCardOriginalPrice:{fontSize:"13px",color:"#b2bec3",textDecoration:"line-through",marginLeft:"6px",fontWeight:"500"},mobileViewDetailsButton:{padding:"10px 16px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#fff",border:"none",borderRadius:"10px",cursor:"pointer",fontWeight:"600",fontSize:"13px",alignSelf:"flex-start",transition:"all 0.3s ease",boxShadow:"0 6px 15px rgba(102, 126, 234, 0.3)"},mobileProductsContainer:{display:"flex",flexDirection:"column",gap:"20px",paddingBottom:"40px"},aiProcessingOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(135deg, rgba(102, 126, 234, 0.9) 0%, rgba(118, 75, 162, 0.9) 100%)",borderRadius:"16px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"white",backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)"},aiIcon:{fontSize:"48px",marginBottom:"15px",animation:"aiPulse 2s infinite"},aiProcessingText:{fontSize:"20px",fontWeight:"700",marginBottom:"8px"},aiSubtext:{fontSize:"14px",opacity:.9,fontWeight:"500"},spinner:{display:"inline-block",width:"18px",height:"18px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 1s linear infinite"},generatingContent:{display:"flex",alignItems:"center",gap:"10px"},imagePreview:{maxWidth:"100%",maxHeight:"400px",borderRadius:"8px",marginBottom:"20px"},previewButtonGroup:{display:"flex",justifyContent:"center",gap:"15px",marginTop:"20px"},previewButton:{padding:"10px 20px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.3s ease"},"@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}},"@keyframes aiPulse":{"0%":{transform:"scale(1)",opacity:1},"50%":{transform:"scale(1.1)",opacity:.8},"100%":{transform:"scale(1)",opacity:1}},"@keyframes modalFadeIn":{"0%":{opacity:0},"100%":{opacity:1}},"@keyframes modalSlideUp":{"0%":{opacity:0,transform:"translateY(30px) scale(0.95)"},"100%":{opacity:1,transform:"translateY(0) scale(1)"}},"@keyframes popupSlideIn":{"0%":{opacity:0,transform:"translateY(40px) scale(0.9)"},"100%":{opacity:1,transform:"translateY(0) scale(1)"}},"@media (max-width: 768px)":{title:{fontSize:"2.5rem",paddingTop:"40px"},customUploadContainer:{padding:"30px 20px",margin:"0 15px"},popupContent:{margin:"10px",maxWidth:"calc(100% - 20px)"},popupBody:{padding:"20px"},grid:{gridTemplateColumns:"1fr",gap:"20px"}}};function n({props:e,fpi:t}){const a=e.application_id.value,n=e.company_id.value,[l,d]=(0,r.useState)([]),[p,s]=(0,r.useState)(!1),[c,g]=(0,r.useState)(null),[m,x]=(0,r.useState)(!1),[b,u]=(0,r.useState)(!1),[f,y]=(0,r.useState)(!1),[h,k]=(0,r.useState)(""),[v,C]=(0,r.useState)(!1),[S,w]=(0,r.useState)(!1),[E,I]=(0,r.useState)(null),[B,W]=(0,r.useState)(null),[z,T]=(0,r.useState)(!1),[F,P]=(0,r.useState)(""),[A,R]=(0,r.useState)(""),[D,j]=(0,r.useState)(null),M="/ext/ab/api/proxy/scan",H=e?.title?.value??"Snap & Shop - Find Products by Image";(0,r.useEffect)((()=>(document.body.style.overflow=m||f||z?"hidden":"",()=>{document.body.style.overflow=""})),[m,f,z]),(0,r.useEffect)((()=>{const e=()=>{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768;u(e)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const O=e=>{const t=`/product/${e.slug||e.id||e.name.toLowerCase().replace(/\s+/g,"-")}`;window.open(t,"_blank")},L=e=>{W(e),T(!0)},U=()=>{x(!1),g(null)},G=e=>`₹${e.toLocaleString()}`,Z=e=>e?e.replace(/-/g," ").replace(/\b\w/g,(e=>e.toUpperCase())):"",$=()=>i().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",width:24,height:24},i().createElement("path",{d:"M4 7h2.586A2 2 0 0 0 8.414 6l.172-.172A2 2 0 0 1 10 5h4a2 2 0 0 1 1.414.586l.172.172A2 2 0 0 0 17.414 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2z"}),i().createElement("circle",{cx:"12",cy:"13",r:"3"})),_=()=>i().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},i().createElement("path",{d:"M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"})),Y=()=>i().createElement("div",{style:o.aiProcessingOverlay},i().createElement("div",{style:{...o.aiIcon}},i().createElement("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},i().createElement("path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"}),i().createElement("path",{d:"M12 12v9"}),i().createElement("path",{d:"m8 17 4 4 4-4"}))),i().createElement("div",{style:o.aiProcessingText},"AI Processing"),i().createElement("div",{style:o.aiSubtext},"Analyzing image patterns"),i().createElement("div",{style:{marginTop:"15px",display:"flex"}},i().createElement("div",{style:{...o.dotsAnimation,...o.dotsAnimation1}}),i().createElement("div",{style:{...o.dotsAnimation,...o.dotsAnimation2}}),i().createElement("div",{style:{...o.dotsAnimation,...o.dotsAnimation3}})));return i().createElement("div",{style:o.container},i().createElement("div",null,i().createElement("title",null,H)),i().createElement("h1",{style:o.title},H),i().createElement("div",{style:o.uploadSection},i().createElement("div",{style:o.customUploadContainer},i().createElement("div",{style:{display:"flex",alignItems:"center",gap:"20px",flexDirection:b?"column":"row",textAlign:b?"center":"left"}},i().createElement("button",{onClick:()=>{y(!0)},style:{...o.mainUploadButton,margin:0,backgroundColor:"white",color:"black",border:"2px solid #7fd7f7",width:b?"100%":"auto"},disabled:p},p?i().createElement(i().Fragment,null,i().createElement("span",{style:o.spinner}),"Analyzing Image..."):i().createElement(i().Fragment,null,i().createElement($,null),"Upload Product Image")),i().createElement("div",{style:{color:"#fff",marginTop:b?"6px":0}},i().createElement("span",{style:o.quickText},"iSnapToShop")," – Upload or generate images to find your perfect product match.")))),f&&i().createElement("div",{style:o.modalOverlay},i().createElement("div",{style:o.modalContent},i().createElement("div",{style:o.modalHeader},i().createElement("h2",{style:o.modalTitle},"Upload or Generate Product Image"),i().createElement("button",{style:o.modalCloseButton,onClick:()=>{y(!1),k(""),C(!1)}},"×")),i().createElement("div",{style:o.modalBody},i().createElement("div",{style:o.modalSection},i().createElement("label",{style:o.modalSectionLabel},"Upload Image"),i().createElement("input",{type:"file",onChange:e=>{const t=e.target.files&&e.target.files[0];t&&(async e=>{if(e)if(e.type.startsWith("image/"))try{g(URL.createObjectURL(e)),s(!0),y(!1);const t=new FormData;t.append("image",e),t.append("company_id",n);const r=await fetch(`${M}//search-by-image-using-store-front?application_id=${a}&company_id=${n}`,{method:"POST",body:t,credentials:"include"}),i=await r.json();d(i.results||[]),i.results&&i.results.length>0&&x(!0)}catch(e){console.error("Error during image upload search:",e),d([]),alert("Error processing image. Please try again.")}finally{s(!1)}else alert("Please select a valid image file")})(t)},accept:"image/*",style:o.fileInput})),i().createElement("div",{style:o.modalDivider},i().createElement("span",{style:o.modalDividerText},"OR")),i().createElement("div",{style:o.modalSection},i().createElement("label",{style:o.modalSectionLabel},"Generate Image via Prompt"),i().createElement("input",{type:"text",style:o.promptInput,placeholder:'Describe your product (e.g., "White jordan sneakers")',value:h,onChange:e=>k(e.target.value),disabled:v}),i().createElement("button",{onClick:()=>async function(e){if(e.trim())try{C(!0);const t=await fetch(`${M}/generate-prompts-to-image?company_id=${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e}),credentials:"include"}),a=await t.json();if(!a.success||!a.imageUrl)throw new Error(a.message||"Image generation failed");I(a.imageUrl),w(!0),k("")}catch(e){console.error("Error generating/searching image:",e),alert("Failed to generate or search image. Please try again."),C(!1)}finally{C(!1)}else alert("Please enter a description for the image")}(h),style:{...o.generateButton,...v||!h?o.generateButtonDisabled:{}},disabled:v||!h},v?i().createElement("div",{style:o.generatingContent},i().createElement("span",{style:o.spinner}),i().createElement("span",null,"Generating...")):"Generate & Use Image"),S&&E&&i().createElement("div",{style:o.modalOverlay},i().createElement("div",{style:{...o.modalContent,maxWidth:"90%",maxHeight:"90vh",overflowY:"auto",display:"flex",flexDirection:"column"}},i().createElement("div",{style:o.modalHeader},i().createElement("h2",{style:o.modalTitle},"Preview Generated Image"),i().createElement("button",{style:o.modalCloseButton,onClick:()=>w(!1)},"×")),i().createElement("div",{style:{...o.modalBody,textAlign:"center",flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between"}},i().createElement("div",{style:{marginBottom:"20px",flex:1}},i().createElement("img",{src:E,alt:"Generated from prompt",style:{maxWidth:"100%",maxHeight:"60vh",borderRadius:"8px",objectFit:"contain"}})),i().createElement("div",{style:{display:"flex",justifyContent:"center",gap:"15px",padding:"20px 0",flexWrap:"wrap"}},i().createElement("button",{onClick:()=>{w(!1),y(!0)},style:{...o.generateButton,backgroundColor:"#f0f0f0",color:"#333",border:"1px solid #ccc",minWidth:"150px",margin:"5px"}},"Regenerate"),i().createElement("button",{onClick:async()=>{if(E){console.log(E,"1111111111");try{s(!0),w(!1),await(async e=>{try{s(!0),y(!1);const t=await fetch(e,{method:"GET",headers:{Accept:"image/*"},mode:"cors"});if(!t.ok)throw new Error(`Failed to fetch image: ${t.status}`);const r=await t.blob();let i=r.type;i&&i.startsWith("image/")||(i="image/png"),console.log("Blob details:",{type:r.type,size:r.size,finalMimeType:i});const o=new FormData,l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(/Android [1-4]\./.test(navigator.userAgent)){console.log("Detected old Android, using special handling");const e=await r.arrayBuffer(),t=new Blob([e],{type:i});o.append("image",t,"generated-image.png")}else if(l)try{const e=new File([r],"generated-image.png",{type:i,lastModified:Date.now()});o.append("image",e)}catch(e){console.log("File constructor failed on mobile, using blob"),o.append("image",r,"generated-image.png")}else{const e=new File([r],"generated-image.png",{type:i,lastModified:Date.now()});o.append("image",e)}o.append("company_id",n),console.log("FormData entries:");for(let e of o.entries())console.log(e[0],e[1]);g(e);const p=await fetch(`${M}/search-by-image?application_id=${a}&company_id=${n}`,{method:"POST",body:o,credentials:"include"});if(!p.ok)throw new Error(`Upload failed: ${p.status} ${p.statusText}`);const c=await p.json();d(c.results||[]),c.results&&c.results.length>0&&x(!0)}catch(e){console.error("Enhanced upload failed:",e),d([]),alert(`Error processing image: ${e.message}`)}finally{s(!1)}})(E)}catch(e){console.error("Error processing generated image:",e),alert("Error processing image. Please try again.")}finally{s(!1)}}},style:{...o.generateButton,backgroundColor:"#4CAF50",minWidth:"150px",margin:"5px"}},"Use This Image"))))))))),(m||p)&&i().createElement("div",{style:o.popupOverlay,onClick:U},i().createElement("div",{style:o.popupContent,onClick:e=>e.stopPropagation()},i().createElement("div",{style:o.popupHeader},i().createElement("h2",{style:o.popupTitle},l.length>0?`Search Results (${l.length} products)`:"Searching for products"),i().createElement("button",{style:o.closeButton,onClick:U},"×")),i().createElement("div",{style:o.popupBody},c&&i().createElement("div",{style:o.popupImageSection},i().createElement("div",{style:o.popupImageTitle},"Your Uploaded Image"),i().createElement("div",{style:o.selectedImageWrapper},i().createElement("img",{src:c,alt:"Uploaded for search",style:o.popupSelectedImage}),p&&i().createElement(Y,null))),p?i().createElement("p",{style:o.loadingText},"Finding perfect matches for you..."):i().createElement(i().Fragment,null,l.length>0&&i().createElement("div",{style:o.resultsSection},i().createElement("div",{style:o.resultsTitle},"Matching Products"),b?i().createElement("div",{style:o.mobileProductsContainer},l.map(((e,t)=>i().createElement("div",{key:t,style:o.mobileCard},i().createElement("img",{src:e.image,alt:e.name,style:o.mobileCardImage,onError:e=>{e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtc2l6ZT0iMTgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIiBmaWxsPSIjOTk5Ij5ObyBJbWFnZTwvdGV4dD48L3N2Zz4="}}),i().createElement("div",{style:o.mobileCardContent},i().createElement("h3",{style:o.mobileCardTitle},e.name),e.category&&i().createElement("p",{style:o.cardCategory},Z(e.category)),e.sizes&&e.sizes.length>0&&i().createElement("div",{style:o.mobileCardPrice},G(e.sizes[0].price.effective.min),e.sizes[0].price.marked.min>e.sizes[0].price.effective.min&&i().createElement("span",{style:o.mobileCardOriginalPrice},G(e.sizes[0].price.marked.min))),i().createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginTop:"10px",flexWrap:"nowrap",alignItems:"center"}},i().createElement("button",{style:{padding:"6px 14px",fontSize:"13px",borderRadius:"4px",border:"none",backgroundColor:"#007BFF",color:"#fff",cursor:"pointer",width:"130px"},onClick:()=>O(e)},"View Details"),i().createElement("button",{style:{padding:"6px 14px",fontSize:"13px",borderRadius:"4px",border:"none",backgroundColor:"#4CAF50",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"5px",width:"130px"},onClick:()=>L(e)},i().createElement(_,null)," Add to Cart"))))))):i().createElement("div",{style:o.grid},l.map(((e,t)=>i().createElement("div",{key:t,style:o.card},i().createElement("img",{src:e.image,alt:e.name,style:o.cardImage,onError:e=>{e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtc2l6ZT0iMTgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIiBmaWxsPSIjOTk5Ij5ObyBJbWFnZTwvdGV4dD48L3N2Zz4="}}),i().createElement("h3",{style:o.cardTitle},e.name.length>27?e.name.slice(0,27)+"...":e.name),e.category&&i().createElement("p",{style:o.cardCategory},Z(e.category)),e.sizes&&e.sizes.length>0&&i().createElement("div",{style:o.cardPrice},G(e.sizes[0].price.effective.min),e.sizes[0].price.marked.min>e.sizes[0].price.effective.min&&i().createElement("span",{style:o.cardOriginalPrice},G(e.sizes[0].price.marked.min))),i().createElement("div",{style:{display:"flex",flexWrap:"nowrap",gap:"8px",marginTop:"4px",marginLeft:"20px",marginBottom:"10px"}},i().createElement("button",{style:{padding:"4px 10px",fontSize:"12px",borderRadius:"4px",border:"none",backgroundColor:"#007BFF",color:"#fff",cursor:"pointer",whiteSpace:"nowrap"},onClick:()=>O(e)},"View Details"),i().createElement("button",{style:{padding:"4px 10px",fontSize:"12px",borderRadius:"4px",border:"none",backgroundColor:"#4CAF50",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px",whiteSpace:"nowrap"},onClick:()=>L(e)},i().createElement(_,{style:{fontSize:"14px"}})," Add to Cart"))))))),0===l.length&&!p&&i().createElement("p",{style:o.noProductsText},"No matching products found."))))),z&&B&&i().createElement("div",{style:o.modalOverlay},i().createElement("div",{style:{...o.modalContent,maxWidth:b?"90%":"500px",padding:"20px"}},i().createElement("div",{style:o.modalHeader},i().createElement("h2",{style:o.modalTitle},"Add to Cart"),i().createElement("button",{style:o.modalCloseButton,onClick:()=>{T(!1),P(""),R("")}},"×")),i().createElement("div",{style:o.modalBody},i().createElement("div",{style:{marginBottom:"20px"}},i().createElement("h3",{style:{marginBottom:"10px"}},B.name),B.sizes&&B.sizes.length>0&&i().createElement("div",{style:{marginBottom:"15px"}},i().createElement("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"}},"Select Size"),i().createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"}},B.sizes.map(((e,t)=>i().createElement("button",{key:t,style:{padding:"8px 12px",border:"1px solid "+(F===e.size?"#4CAF50":"#ddd"),backgroundColor:F===e.size?"#e8f5e9":"#fff",borderRadius:"4px",cursor:"pointer",minWidth:"50px",textAlign:"center"},onClick:()=>P(e.size)},e.size))))),i().createElement("div",{style:{marginBottom:"15px"}},i().createElement("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"}},"Enter Pincode"),i().createElement("input",{type:"text",value:A,onChange:e=>{const t=e.target.value.replace(/\D/g,"");t.length<=6&&R(t)},placeholder:"6-digit pincode",style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px"}})),i().createElement("button",{style:{width:"100%",padding:"12px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},onClick:()=>{F?A&&6===A.length?(alert(`Added ${B.name} (Size: ${F}) to cart for pincode ${A}`),T(!1),P(""),R("")):alert("Please enter a valid 6-digit pincode"):alert("Please select a size")}},i().createElement(_,null)," Add to Cart"))))))}n.serverFetch=async({fpi:e})=>({});const l={label:"iSnapToShop",name:"product-list",props:[{id:"title",label:"Page Title",type:"text",default:"",info:"Page Title"},{id:"company_id",label:"Company ID",type:"text",default:"",info:"Company ID",require:!0},{id:"application_id",label:"Application ID",type:"text",default:"",info:"Application ID",require:!0}],blocks:[]},d={"product-list":{...a}};exports.sections=t})();